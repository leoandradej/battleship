(()=>{"use strict";const e=class{constructor(e){this.name=e,this.hits=[],this.sunkShips=[]}},t=class{constructor(){this.gridDimension=100,this.player=new e("player"),this.computer=new e("computer"),this.createGameboard(this.player.name),this.createGameboard(this.computer.name),this.angle=0,this.draggedShip,this.notDropped,this.playerTurn,this.movesAlreadyMade=[],this.gameOver=!1}createGameboard(e){const t=document.querySelector("[data-gameboards-container]"),r=document.createElement("div");r.className="gameboard",r.id=e;for(let e=0;e<this.gridDimension;e++){const t=document.createElement("div");t.className="cell",t.id=e,r.append(t)}t.append(r)}placeShip(e,t,r){const s=document.querySelectorAll(`#${e} div`);let a,n=Math.random()<.5,o="player"===e?0===this.angle:n,i=Math.floor(Math.random()*this.gridDimension),c=r||i,l=o?c<=this.gridDimension-t.length?c:this.gridDimension-t.length:c<=this.gridDimension-10*t.length?c:c-10*t.length+10,d=[];for(let e=0;e<t.length;e++)o?d.push(s[Number(l)+e]):d.push(s[Number(l)+10*e]);o?d.every(((e,t)=>a=d[0].id%10!=10-(d.length-(t+1)))):d.every(((e,t)=>a=d[0].id<10*t+1+90));const h=d.every((e=>!e.classList.contains("taken")));a&&h?(d.forEach((e=>{e.classList.add(t.name),e.classList.add("taken")})),d[0].classList.add("start"),d[d.length-1].classList.add("end"),parseInt(d[1].id)===parseInt(d[0].id)+1?d.forEach((e=>e.classList.add("horizontal"))):d.forEach((e=>e.classList.add("vertical")))):("computer"===e&&this.placeShip(e,t,r),"player"===e&&(this.notDropped=!0))}checkScore=(e,t,r)=>{const s=document.querySelector("[data-display-info]"),a=(a,n)=>{t.filter((e=>e===a)).length===n&&("player"===e&&(s.textContent=`YOU HAVE SUNK COMPUTER'S ${a.toUpperCase()}!`,this.player.hits=t.filter((e=>e!==a))),"computer"===e&&(s.textContent=`COMPUTER HAS SUNK YOUR ${a.toUpperCase()}!`,this.computer.hits=t.filter((e=>e!==a))),r.push(a))};a("destroyer",2),a("submarine",3),a("cruiser",3),a("battleship",4),a("carrier",5),5===this.player.sunkShips.length&&(s.textContent="YOU HAVE SUNK ALL COMPUTER'S SHIPS. YOU WON!",this.gameOver=!0),5===this.computer.sunkShips.length&&(s.textContent="COMPUTER HAS SUNK ALL YOUR SHIPS. YOU LOSE!",this.gameOver=!0)}},r=class{constructor(e,t){this.name=e,this.length=t}},s=new r("destroyer",2),a=new r("submarine",3),n=new r("cruiser",3),o=new r("battleship",4),i=new r("carrier",5);(()=>{const e=new t(10);document.querySelector(".rotate-ship").addEventListener("click",(()=>{const t=document.querySelector("[data-ships]"),r=Array.from(t.children);e.angle=0===e.angle?90:0,r.forEach((t=>t.style.transform=`rotate(${e.angle}deg)`))}));const r=[s,a,n,o,i];r.forEach((t=>e.placeShip(e.computer.name,t)));const c=t=>{e.notDropped=!1,e.draggedShip=t.target},l=e=>{e.preventDefault()},d=t=>{const s=t.target.id,a=r[e.draggedShip.id];e.placeShip(e.player.name,a,s),e.notDropped||e.draggedShip.remove()},h=document.querySelector("[data-ships-container]");Array.from(h.children).forEach((e=>e.addEventListener("dragstart",c))),document.querySelectorAll(`#${e.player.name} div`).forEach((e=>{e.addEventListener("dragover",l),e.addEventListener("drop",d)}));const m=()=>{const t=document.querySelector("[data-display-info]"),r=document.querySelector("[data-display-turn]");e.gameOver||(r.textContent="COMPUTERS TURN",t.textContent="COMPUTER IS THINKING...",setTimeout((()=>{let r;const s=()=>{let t=Math.floor(Math.random()*e.gridDimension);if(-1===e.movesAlreadyMade.indexOf(t))e.movesAlreadyMade.push(t),r=t;else{if(100===e.movesAlreadyMade.length)return;s()}};s();const a=document.querySelectorAll("#player div");if(a[r].classList.contains("taken")&&!a[r].classList.contains("boom")){a[r].classList.add("boom"),t.textContent="COMPUTER HIT YOUR SHIP!";let s=Array.from(a[r].classList);e.computer.hits.push(...s.filter((e=>"cell"!==e&&"taken"!==e&&"boom"!==e))),e.checkScore(e.computer.name,e.computer.hits,e.computer.sunkShips)}else t.textContent="NOTHING HIT THIS TIME",a[r].classList.add("miss")}),3e3),setTimeout((()=>{e.gameOver||(e.playerTurn=!0,r.textContent="YOUR TURN",t.textContent="PLEASE MAKE YOUR MOVE",document.querySelectorAll("#computer div").forEach((e=>{e.classList.contains("miss")||e.classList.contains("boom")||e.addEventListener("click",p)})))}),6e3))},p=t=>{const r=document.querySelector("[data-display-info]");if(!e.gameOver&&t.target.classList.contains("taken")){t.target.classList.add("boom"),r.textContent="YOU HIT COMPUTERS SHIP!";let s=Array.from(t.target.classList);e.player.hits.push(...s.filter((e=>"cell"!==e&&"taken"!==e&&"boom"!==e))),e.checkScore(e.player.name,e.player.hits,e.player.sunkShips)}t.target.classList.contains("taken")||(r.textContent="NOTHING HIT THIS TIME",t.target.classList.add("miss")),e.playerTurn=!1,document.querySelectorAll("#computer div").forEach((e=>e.replaceWith(e.cloneNode(!0)))),setTimeout(m,3e3)};document.querySelector(".start-btn").addEventListener("click",(()=>{if(void 0===e.playerTurn){const t=document.querySelector("[data-ships]"),r=document.querySelector("[data-display-info]"),s=document.querySelector("[data-display-turn]");if(0!=t.children.length)r.textContent="PLEASE PLACE ALL YOUR SHIPS FIRST!";else{const t=document.querySelectorAll("#computer div"),a=document.querySelector(".buttons-container");t.forEach((e=>e.addEventListener("click",p))),e.playerTurn=!0,s.textContent="YOUR TURN",r.textContent="THE GAME HAS STARTED",a.style.display="none"}}}))})()})();